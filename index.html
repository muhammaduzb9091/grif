<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web AI - Chat</title>
    <link rel="icon" type="image/png" href="img/logo.jpg" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html {
            overflow: hidden;
        }

        body {
            margin: 0;
            padding: 0;
            background: #161618;
            color: #ffffff;
            font-family: 'Manrope', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
}

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 70px;
            height: 100vh;
            background: linear-gradient(180deg, #1c1c1e 0%, #0e0e10 100%);
            border-right: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            transition: width 0.4s cubic-bezier(0.4, 0.0, 0.2, 1), box-shadow 0.4s ease, transform 0.4s ease;
            z-index: 10;
            overflow: hidden;
        }

        .sidebar.active {
            width: 240px;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.6);
            transform: translateX(0);
        }

        .sidebar-toggle {
            position: absolute;
            bottom: 20px;
            left: 35px;
            font-size: 20px;
            color: #ffffff;          
            border-radius: 80%;
            padding: 14px;
            cursor: pointer;
            transition: transform 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
            z-index: 11;
            transform: translateX(-50%);
            
        }

        .sidebar-toggle:hover {
            background: #28282A;          
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }

        .sidebar-toggle.active {
            transform: translateX(-50%) rotate(180deg);
            background: #28282A;
        }

        .sidebar-item {
            width: 100%;
            padding: 15px 0;
            display: flex;
            align-items: center;
            color: #ffffff;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease, opacity 0.3s ease;
            opacity: 0.7;
            position: relative;
            overflow: hidden;
        }

        .sidebar-item:hover {
            background: linear-gradient(90deg, rgba(30, 144, 255, 0.2) 0%, rgba(0, 255, 136, 0.1) 100%);
            opacity: 1;
            transform: translateX(5px);
        }

        .sidebar-item::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: transparent;
            transition: background 0.3s ease;
        }

        .sidebar-item:hover::after {
            background: #1e90ff;
        }

        .sidebar-item i {
            font-size: 24px;
            width: 70px;
            text-align: center;
            transition: transform 0.3s ease, color 0.3s ease;
        }

        .sidebar-item:hover i {
            transform: scale(1.15);
            color: #1e90ff;
        }

        .sidebar-item span {
            display: none;
            font-size: 16px;
            font-weight: 600;
            letter-spacing: 0.5px;
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .sidebar.active .sidebar-item span {
            display: inline;
            opacity: 1;
            transform: translateX(0);
        }

        .sidebar-logo {
            display: block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 20px auto;
            transition: transform 0.4s ease, width 0.4s ease, height 0.4s ease, opacity 0.4s ease, filter 0.3s ease;
            filter: brightness(1);
        }

        .sidebar.active .sidebar-logo {
            width: 60px;
            height: 60px;
            transform: rotate(360deg);
            filter: brightness(1.2);
        }

        .hamburger {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 24px;
            color: #ffffff;
            cursor: pointer;
            z-index: 20;
        }

        .hamburger:hover {
            opacity: 0.8;
        }

        .notification {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 24px;
            color: #ffffff;
            cursor: pointer;
            z-index: 20;
        }

        .notification:hover {
            opacity: 0.8;
        }

       .brand-name {
    font-size: 48px;
    font-weight: 700;
    margin-bottom: 20px;
    letter-spacing: 2px;
    text-transform: uppercase;
    position: absolute;
    top: calc(50% - 150px); /* Inputga yaqinroq joylashishi uchun */
    transition: top 0.5s ease, transform 0.5s ease;
    z-index: 5;
}

.brand-name.raised {
    top: 20px; /* Xabar yozilganda tepaga chiqadigan pozitsiya */
}

        .mobile-logo-container {
            display: none;
            flex-direction: column;
            align-items: center;
            position: absolute;
            top: 40%;
            transform: translateY(-50%);
            z-index: 5;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .mobile-logo-container.hidden {
            opacity: 0;
            transform: translateY(-60%);
            pointer-events: none;
        }

        .mobile-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 10px;
        }

        .mobile-brand-name {
            font-size: 36px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #ffffff;
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
                transform: translateY(-50%);
            }
            100% {
                opacity: 0;
                transform: translateY(-60%);
            }
        }

        .chat-container {
            width: 100%;
            max-width: 800px;
            height: 60%;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 20px;
            margin-top: 90px;
            margin-left: 80px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            box-sizing: border-box;
            transition: margin-left 0.4s ease;
        }

        .sidebar.active ~ .chat-container {
            margin-left: 250px;
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .message {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 16px;
            line-height: 1.5;
            margin-top: 10px;
            position: relative;
        }

        .user-message {
            background: rgba(255, 255, 255, 0.2);
            align-self: flex-end;
            margin-left: 30%;
        }

        .ai-message {
            background: rgba(0, 0, 0, 0.3);
            align-self: flex-start;
            margin-right: 30%;
        }

        .wiki-link {
            color: #1e90ff;
            text-decoration: underline;
            cursor: pointer;
        }

        .typing-indicator {
            display: flex;
            gap: 5px;
            align-self: flex-start;
            margin-right: 30%;
            padding: 10px 15px;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            animation: typing 1.2s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                opacity: 0.2;
                transform: scale(0.8);
            }
            40% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        .input-container {
            width: 100%;
            max-width: 800px;
            display: flex;
            justify-content: center;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            align-items: center;
            margin-left: 80px;
            box-sizing: border-box;
            transition: margin-left 0.4s ease, top 0.5s ease, transform 0.5s ease;
        }

        .sidebar.active ~ .input-container {
            margin-left: 250px;
        }

        .input-container.first-message-sent {
            top: auto;
            bottom: 20px;
            transform: none;
        }

        .send-button {
            position: absolute;
            right: 10px;
            margin-right: 2px;
            margin-top: 28px;
            top: 50%;
            transform: translateY(-50%);
            background-color: #858585;
            padding: 12px;
            border-radius: 50%;
            border: none;
            color: #ffffff;
            font-size: 15px;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .mic-button {
            position: absolute;
            right: 50px;
            margin-right: 10px;
            margin-top: 28px;
            top: 50%;
            transform: translateY(-50%);
            background-color: #858585;
            padding: 12px;
            border-radius: 50%;
            border: none;
            color: #ffffff;
            font-size: 15px;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .mic-button.listening {
            background-color: #ff4444;
            color: #ffffff;
        }

      

        input[type="text"] {
            width: 100%;
            padding: 40px 90px 60px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: #ffffff;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            box-sizing: border-box;
            font-family: 'Manrope', sans-serif;
        }

        input[type="text"]::placeholder {
            color: rgba(255, 255, 255, 0.5);
            line-height: 1;
            vertical-align: top;
            padding-top: 5px;
        }

        .input-container:focus-within input[type="text"] {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        input[type="text"]:focus::placeholder {
            opacity: 0;
        }

        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 5px;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .message-actions:hover {
            opacity: 1;
        }

        .action-icon {
            font-size: 16px;
            cursor: pointer;
            color: #ffffff;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .action-icon:hover {
            transform: scale(1.2);
        }

        .action-icon.liked {
            color: #50c878;
        }

        .action-icon.disliked {
            color: #ff4444;
        }

        .action-icon.copy:hover {
            color: #1e90ff;
        }

        .action-icon.speak:hover {
            color: #ffcc00;
        }

        .action-icon.speaking {
            color: #ffcc00;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1.2);
                opacity: 1;
            }
            50% {
                transform: scale(1.4);
                opacity: 0.7;
            }
            100% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
                background: linear-gradient(180deg, #1a1a1a 0%, #000000 100%);
                border-radius: 0 10px 10px 0;
                border-right: 1px solid rgba(255, 255, 255, 0.1);
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
                transform: translateX(-100%);
                opacity: 0;
                visibility: hidden;
                transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55), opacity 0.4s ease, visibility 0.4s;
            }
            .sidebar.active {
                transform: translateX(0);
                opacity: 1;
                visibility: visible;
                display: flex;
            }
            .sidebar-item {
                padding: 22px 20px;
                justify-content: flex-start;
                gap: 15px;
                opacity: 0;
                transform: translateX(-30px);
                transition: opacity 0.3s ease, transform 0.3s ease;
            }
            .sidebar.active .sidebar-item {
                opacity: 1;
                transform: translateX(0);
            }
            .sidebar.active .sidebar-item span {
                display: inline;
                opacity: 1;
                transform: translateX(0);
            }
            .sidebar.active .sidebar-item:nth-child(1) {
                transition-delay: 0.15s;
            }
            .sidebar.active .sidebar-item:nth-child(2) {
                transition-delay: 0.3s;
            }
            .sidebar.active .sidebar-item:nth-child(3) {
                transition-delay: 0.45s;
            }
            .sidebar.active .sidebar-item:nth-child(4) {
                transition-delay: 0.6s;
            }
            .sidebar-item:hover {
                background: linear-gradient(90deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 100%);
            }
            .sidebar-item i {
                font-size: 22px;
                width: 40px;
                color: #ffffff;
            }
            .sidebar-item span {
                font-size: 20px;
                font-weight: 600;
                letter-spacing: 0.5px;
                margin-left: 10px;
                color: #ffffff;
            }
            .sidebar-logo {
                display: block;
                opacity: 0;
                transform: translateY(-20px);
                transition: opacity 0.3s ease, transform 0.3s ease;
            }
            .sidebar.active .sidebar-logo {
                opacity: 1;
                transform: translateY(0);
            }
            .sidebar-toggle {
                display: none;
            }
            .hamburger {
                display: block;
            }
            .hamburger.hidden {
                display: none;
            }
            .notification {
                display: block;
            }
            .brand-name {
                display: none;
            }
            .mobile-logo-container {
                display: flex;
            }
            .chat-container {
                max-width: 100%;
                margin-left: 20px;
                margin-right: 20px;
                margin-top: 90px;
                overflow-y: auto;
                overflow-x: hidden;
                max-height: calc(100vh - 220px);
                box-sizing: border-box;
            }
            .sidebar.active ~ .chat-container {
                margin-left: 20px;
            }
            .input-container {
                max-width: calc(100% - 40px);
                margin-left: 20px;
                margin-right: 20px;
                margin-top: 190px;
                position: fixed;
                bottom: 20px;
                transform: none;
                overflow-x: hidden;
                box-sizing: border-box;
            }
            .sidebar.active ~ .input-container {
                margin-left: 20px;
            }
            .input-container.first-message-sent {
                bottom: 20px;
            }
            input[type="text"] {
                max-width: calc(100% - 0.1px);
                padding: 40px 90px 60px 20px;
                box-sizing: border-box;
                font-family: 'Manrope', sans-serif;
            }
            .send-button {
                right: 10px;
                margin-right: 1.0px;
                margin-top: 28px;
                top: 50%;
                font-size: 15px;
                transform: translateY(-50%);
            }
            .mic-button {
                right: 50px;
                margin-right: 8px;
                margin-top: 28px;
                top: 50%;
                font-size: 15px;
                transform: translateY(-50%);
            }
            .message {
                margin-top: 15px;
            }
            .message-actions {
                gap: 8px;
                margin-top: 8px;
            }
            .action-icon {
                font-size: 14px;
            }
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .message-time {
    font-size: 12px;
    opacity: 0.7;
    margin-top: 1px;
    text-align: right;
}

/* Desktop stil */
.user-profile {
    position: fixed;
    top: 20px;
    right: 70px;
    width: 30px;
    height: 30px;
    cursor: pointer;
    z-index: 20;
    transition: all 0.3s ease;
    display: block; /* Desktopda ko'rsatish */
    margin-right: -50px;
}

.profile-image {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid rgba(255, 255, 255, 0.8);
    transition: all 0.3s ease;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}


.user-profile:hover .profile-image {
    border-color: #d2dce7ff;
    box-shadow: 0 0 15px rgba(135, 160, 184, 0.4);
}

/* Mobil versiyada butunlay yashirish */
@media (max-width: 768px) {
    .user-profile {
        display: none !important;
    }
    
    /* Notificationni asl holatiga qaytarish */
    .notification {
        right: 20px;
    }
}

.settings-icon {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 30px;
    height: 30px;
    cursor: pointer;
    z-index: 20;
    transition: all 0.3s ease;
    display: block;
    margin-right: -5px;
}

.settings-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    filter: invert(1) brightness(0.8);
    transition: all 0.3s ease;
    opacity: 0.7;
}


/* Mobil versiyada yashirish */
@media (max-width: 768px) {
    .settings-icon {
        display: none !important;
    }
}



.settings-icon:hover .settings-img {
    animation: spin 1.5s linear infinite;
    opacity: 1;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.footer-credit {
    position: fixed;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 8px;
    color: rgba(255, 255, 255, 0.7);
    font-family: 'Poppins', sans-serif;
    font-size: 14px;
    font-weight: 500;
    z-index: 10;
    transition: all 0.3s ease;
}

.verify-icon {
    width: 16px;
    height: 16px;
    object-fit: contain;
    filter: brightness(0) invert(1) opacity(0.7);
    transition: all 0.3s ease;
}



.footer-credit:hover .verify-icon {
    
    opacity: 1;
}

/* Mobil versiyada yashirish */
@media (max-width: 768px) {
    .footer-credit {
        display: none !important;
    }
}

    </style>
</head>
<body>
    <div class="hamburger" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </div>
    <div class="notification" onclick="goToNotifications()">
        <i class="fas fa-bell"></i>
    </div>
    <div class="user-profile desktop-only" onclick="goToProfile()">
    <img src="img/profile-image6.png" alt="User Profile" class="profile-image">
</div>
<div class="settings-icon desktop-only" onclick="goToSettings()">
    <img src="img/settings.png" alt="Settings" class="settings-img">
</div>
    <div class="sidebar" id="sidebar">
        <img src="img/logo.jpg" alt="Logo" class="sidebar-logo">
        <div class="sidebar-item" onclick="window.location.href='index.html'">
            <i class="fas fa-home"></i>
            <span>Bosh sahifa</span>
        </div>
        <div class="sidebar-item" onclick="window.location.href='games.html'">
            <i class="fas fa-gamepad"></i>
            <span>O'yinlar</span>
        </div>
        <div class="sidebar-item" onclick="window.location.href='tests.html'">
            <i class="fas fa-question"></i>
            <span>Testlar</span>
        </div>
        <div class="sidebar-item" onclick="window.location.href='media.html'">
            <i class="fas fa-video"></i>
            <span>Media</span>
        </div>
    </div>
    <div class="sidebar-toggle" onclick="toggleSidebarDesktop()">
        <i class="fas fa-angle-double-right"></i>
    </div>
    <canvas id="stars"></canvas>
    <div class="brand-name">Web AI</div>
    <div class="mobile-logo-container" id="mobileLogoContainer">
        <img src="img/logo-2.png" alt="Mobile Logo" class="mobile-logo">
        <div class="mobile-brand-name">Web AI</div>
    </div>
    <div class="chat-container" id="chatContainer"></div>
    <div class="input-container">
        <input type="text" id="userInput" placeholder="Nimani bilmoqchisiz?">
        <button class="mic-button" onclick="startSpeechRecognition()">
            <i class="fas fa-microphone"></i>
        </button>
        <button class="send-button" onclick="sendMessage()">
            <i class="fas fa-arrow-up"></i>
        </button>
    </div>

    <div class="footer-credit desktop-only">
   
    <span>By M Corp</span>
     <img src="img/verify.png" alt="Verified" class="verify-icon">
</div>

    <script>
        // Tasodifiy kirish so'zlari ro'yxati
        const introPhrases = [
            "Albatta, keling, tushuntirib beraman.",
            "Ha, bu haqda batafsil gaplashamiz.",
            "Mayli, sizga tushunarli qilib izohlayman:",
            "Xo‘p, qadam-baqadam tushuntiraman:"
        ];

        // Tasodifiy davom so'zlari ro'yxati
        const followUpPhrases = [
            "Yana qanday ma'lumot haqida bilishni istaysiz?",
            "Boshqa qanday savollaringiz bor?",
            "Yana nimalarni bilmoqchisiz?",
            "Keyingi savolingiz qanday?",
            "Boshqa mavzular haqida gaplashamizmi?"
        ];

        // Tasodifiy kirish so'zini tanlash funksiyasi
        function getRandomIntro() {
            return introPhrases[Math.floor(Math.random() * introPhrases.length)];
        }

        // Tasodifiy davom so'zini tanlash funksiyasi
        function getRandomFollowUp() {
            return followUpPhrases[Math.floor(Math.random() * followUpPhrases.length)];
        }

        // Sidebar toggle funksiyasi (mobil uchun)
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.querySelector('.hamburger');
            sidebar.classList.toggle('active');
            hamburger.classList.toggle('hidden');
        }

        // Desktop sidebar toggle funksiyasi
        function toggleSidebarDesktop() {
            const sidebar = document.getElementById('sidebar');
            const toggleButton = document.querySelector('.sidebar-toggle');
            sidebar.classList.toggle('active');
            toggleButton.classList.toggle('active');
        }

        // Mobil versiyada tashqaridan bosish orqali sidebar yopish
        document.body.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.querySelector('.hamburger');
            const notification = document.querySelector('.notification');
            if (window.innerWidth <= 768 && sidebar.classList.contains('active') && !sidebar.contains(e.target) && !hamburger.contains(e.target) && !notification.contains(e.target)) {
                sidebar.classList.remove('active');
                hamburger.classList.remove('hidden');
            }
        });

        // Notification sahifasiga o'tish
        function goToNotifications() {
            window.location.href = 'notification.html';
        }

        function goToProfile() {
    window.location.href = 'profile.html';
}

function goToSettings() {
    window.location.href = 'settings.html';
}

        // Yulduzlar va uchib o'tadigan yulduzlar animatsiyasi
        const canvas = document.getElementById('stars');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const stars = [];
        const shootingStars = [];

        for (let i = 0; i < 100; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 1.5,
                alpha: Math.random(),
                speed: Math.random() * 0.05
            });
        }

        function createShootingStar() {
            const position = Math.floor(Math.random() * 3);
            let x, y;

            switch (position) {
                case 0:
                    x = 0;
                    break;
                case 1:
                    x = canvas.width / 2;
                    break;
                case 2:
                    x = canvas.width;
                    break;
            }

            y = Math.random() * canvas.height * 0.3;

            shootingStars.push({
                x: x,
                y: y,
                radius: Math.random() * 1.5 + 0.5,
                length: Math.random() * 20 + 15,
                speed: Math.random() * 4 + 4,
                dx: -(Math.random() * 4 + 2),
                dy: Math.random() * 4 + 2,
                alpha: Math.random() * 0.3 + 0.3
            });
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            stars.forEach(star => {
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
                ctx.fill();
                star.alpha += star.speed;
                if (star.alpha > 1 || star.alpha < 0) star.speed = -star.speed;
            });

            shootingStars.forEach((star, index) => {
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
                ctx.fill();

                ctx.beginPath();
                ctx.moveTo(star.x, star.y);
                ctx.lineTo(star.x - star.length * star.dx / star.speed, star.y - star.length * star.dy / star.speed);
                ctx.strokeStyle = `rgba(255, 255, 255, ${star.alpha * 0.3})`;
                ctx.lineWidth = 1.2;
                ctx.stroke();

                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius + 1.5, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha * 0.1})`;
                ctx.fill();

                star.x += star.dx;
                star.y += star.dy;
                star.alpha -= 0.01;
                if (star.x < 0 || star.y > canvas.height || star.alpha <= 0) {
                    shootingStars.splice(index, 1);
                }
            });

            requestAnimationFrame(animate);
        }

        animate();
        setInterval(createShootingStar, 2000);

        // Chat funksiyasi
        const chatContainer = document.getElementById('chatContainer');
        const userInput = document.getElementById('userInput');
        const inputContainer = document.querySelector('.input-container');
        const micButton = document.querySelector('.mic-button');
        const mobileLogoContainer = document.getElementById('mobileLogoContainer');
        let isFirstMessage = true;
        let currentSpeech = null;

        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = '<span></span><span></span><span></span>';
            typingDiv.id = 'typingIndicator';
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingDiv = document.getElementById('typingIndicator');
            if (typingDiv) {
                typingDiv.remove();
            }
        }

        function speakText(text, speakIcon) {
            if (currentSpeech) {
                window.speechSynthesis.cancel();
                currentSpeech = null;
                speakIcon.classList.remove('speaking');
                speakIcon.title = 'Ovoz eshitish';
                return;
            }

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'uz-UZ';
            utterance.pitch = 1.0;
            utterance.rate = 1.0;
            utterance.volume = 1.0;

            const voices = window.speechSynthesis.getVoices();
            const uzVoice = voices.find(voice => voice.lang === 'uz-UZ') || voices.find(voice => voice.lang.includes('en-')) || voices[0];
            utterance.voice = uzVoice;

            utterance.onstart = () => {
                speakIcon.classList.add('speaking');
                speakIcon.title = 'To\'xtatish';
                currentSpeech = utterance;
            };

            utterance.onend = () => {
                speakIcon.classList.remove('speaking');
                speakIcon.title = 'Ovoz eshitish';
                currentSpeech = null;
            };

            utterance.onerror = (event) => {
                console.error('Speech synthesis error:', event.error);
                speakIcon.classList.remove('speaking');
                speakIcon.title = 'Ovoz eshitish';
                currentSpeech = null;
                addMessage('Ovozli o\'qishda xato yuz berdi. Iltimos, qayta urinib ko\'ring!', false);
            };

            window.speechSynthesis.speak(utterance);
        }

       function addMessage(content, isUser, isFullArticle = false) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
    
    // Vaqtni olish
    const now = new Date();
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const timeString = `${hours}:${minutes}`;
    
    // Xabar va vaqtni qo'shish
    messageDiv.innerHTML = `${content}<div class="message-time">${timeString}</div>`;
    
    chatContainer.appendChild(messageDiv);

    if (!isUser && isFullArticle) {
        const actionsDiv = document.createElement('div');
        actionsDiv.className = 'message-actions';
        actionsDiv.innerHTML = `
            <i class="fas fa-thumbs-up action-icon like-icon" title="Yoqdi"></i>
            <i class="fas fa-thumbs-down action-icon dislike-icon" title="Yoqmadi"></i>
            <i class="fas fa-copy action-icon copy-icon" title="Nusxalash"></i>
            <i class="fas fa-volume-up action-icon speak-icon" title="Ovoz eshitish"></i>
        `;
        messageDiv.appendChild(actionsDiv);

        const likeIcon = actionsDiv.querySelector('.like-icon');
        const dislikeIcon = actionsDiv.querySelector('.dislike-icon');
        const copyIcon = actionsDiv.querySelector('.copy-icon');
        const speakIcon = actionsDiv.querySelector('.speak-icon');

        likeIcon.addEventListener('click', function() {
            if (this.classList.contains('liked')) {
                this.classList.remove('liked');
            } else {
                this.classList.add('liked');
                dislikeIcon.classList.remove('disliked');
            }
        });

        dislikeIcon.addEventListener('click', function() {
            if (this.classList.contains('disliked')) {
                this.classList.remove('disliked');
            } else {
                this.classList.add('disliked');
                likeIcon.classList.remove('liked');
            }
        });

        copyIcon.addEventListener('click', function() {
            const textToCopy = messageDiv.innerText;
            navigator.clipboard.writeText(textToCopy).then(() => {
                copyIcon.classList.add('copied');
                copyIcon.title = 'Nusxalandi!';
                setTimeout(() => {
                    copyIcon.classList.remove('copied');
                    copyIcon.title = 'Nusxalash';
                }, 2000);
            }).catch(err => {
                console.error('Nusxalashda xato:', err);
            });
        });

        speakIcon.addEventListener('click', function() {
            const textToSpeak = messageDiv.innerText;
            speakText(textToSpeak, this);
        });
    }

    chatContainer.scrollTop = chatContainer.scrollHeight;

    if (!isUser) {
        const links = messageDiv.querySelectorAll('.wiki-link');
        links.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                fetchFullArticle(this.getAttribute('data-title'));
            });
        });
    }
}

        function extractMainTopic(message) {
            const lowerMessage = message.toLowerCase();
            const noiseWords = /\b(nima|haqida|ma'lumot|bilasanmi|bera olasanmi|bilmoqchiman|shu|shularni)\b/gi;
            let cleanedMessage = lowerMessage.replace(noiseWords, '').trim();

            if (cleanedMessage.startsWith('menga') || cleanedMessage.startsWith('men uchun')) {
                const words = cleanedMessage.split(/\s+/);
                if (cleanedMessage.startsWith('menga') && words.length > 1) {
                    return words[1];
                } else if (cleanedMessage.startsWith('men uchun') && words.length > 2) {
                    return words[2];
                }
                return '';
            }

            const words = cleanedMessage.split(/\s+/);
            return words.find(word => word.length > 0) || '';
        }

        async function searchWikipedia(query) {
            try {
                const searchUrl = `https://uz.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&format=json&origin=*`;
                const response = await fetch(searchUrl);
                const data = await response.json();

                if (data.query.search.length > 0) {
                    const firstResult = data.query.search[0];
                    const title = firstResult.title;
                    getArticleContent(title, query);
                } else {
                    hideTypingIndicator();
                    addMessage(`Kechirasiz, men "${query}" so'rovingiz bo'yicha ma'lumot topa olmadim. Iltimos, so'rovni aniqlashtiring!`, false);
                }
            } catch (error) {
                console.error('Wikipedia API xatosi:', error);
                hideTypingIndicator();
                addMessage('Ma\'lumot olishda xatolik yuz berdi. Iltimos, qayta urinib ko\'ring!', false);
            }
        }

       async function getArticleContent(title, originalQuery) {
    try {
        // Avval rasmni olish uchun API so'rovi
        const imageUrl = `https://uz.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(title)}&prop=pageimages&format=json&origin=*&pithumbsize=200`;
        const imageResponse = await fetch(imageUrl);
        const imageData = await imageResponse.json();
        
        let imageHtml = '';
        const imagePages = imageData.query.pages;
        const imagePageId = Object.keys(imagePages)[0];
        
        if (imagePageId !== '-1' && imagePages[imagePageId].thumbnail) {
            const imageSource = imagePages[imagePageId].thumbnail.source;
            imageHtml = `<div style="float: right; margin-left: 15px; margin-bottom: 15px;"><img src="${imageSource}" alt="${title}" style="max-width: 200px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"></div>`;
        }

        // Keyin matnni olish uchun API so'rovi
        const contentUrl = `https://uz.wikipedia.org/w/api.php?action=query&prop=extracts&exintro=true&exsentences=2&titles=${encodeURIComponent(title)}&format=json&origin=*`;
        const response = await fetch(contentUrl);
        const data = await response.json();

        const pages = data.query.pages;
        const pageId = Object.keys(pages)[0];

        if (pageId !== '-1' && pages[pageId].extract) {
            const extract = pages[pageId].extract;
            const cleanText = extract.replace(/<\/?[^>]+(>|$)/g, "");
            let shortAnswer = cleanText.substring(0, 250);
            if (cleanText.length > 250) {
                shortAnswer += '...';
            }
            const fullResponse = `${getRandomIntro()} ${imageHtml}<br>${shortAnswer}<br><br><a href="#" class="wiki-link" data-title="${encodeURIComponent(title)}">Ko'proq o'qish</a>`;
            hideTypingIndicator();
            addMessage(fullResponse, false);
        } else {
            hideTypingIndicator();
            addMessage(`UzVikipediyada "${originalQuery}" bo'yicha ma'lumot topilmadi. Iltimos, so'rovni aniqlashtiring!`, false);
        }
    } catch (error) {
        console.error('Wikipedia maqola xatosi:', error);
        hideTypingIndicator();
        addMessage('Ma\'lumot olishda xatolik yuz berdi. Iltimos, qayta urinib ko\'ring!', false);
    }
}
        async function fetchFullArticle(title) {
    try {
        showTypingIndicator();
        
        // Rasmni olish uchun API so'rovi
        const imageUrl = `https://uz.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(title)}&prop=pageimages&format=json&origin=*&pithumbsize=300`;
        const imageResponse = await fetch(imageUrl);
        const imageData = await imageResponse.json();
        
        let imageHtml = '';
        const imagePages = imageData.query.pages;
        const imagePageId = Object.keys(imagePages)[0];
        
        if (imagePageId !== '-1' && imagePages[imagePageId].thumbnail) {
            const imageSource = imagePages[imagePageId].thumbnail.source;
            imageHtml = `<div style="margin-bottom: 15px; text-align: center;"><img src="${imageSource}" alt="${title}" style="max-width: 100%; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"></div>`;
        }

        // Matnni olish uchun API so'rovi
        const contentUrl = `https://uz.wikipedia.org/w/api.php?action=query&prop=extracts&titles=${title}&format=json&origin=*`;
        const response = await fetch(contentUrl);
        const data = await response.json();

        const pages = data.query.pages;
        const pageId = Object.keys(pages)[0];

        if (pageId !== '-1' && pages[pageId].extract) {
            const extract = pages[pageId].extract;
            const cleanText = extract.replace(/<\/?[^>]+(>|$)/g, "");
            let shortAnswer = cleanText.substring(0, 1200);
            if (cleanText.length > 1200) {
                const sentenceEndings = ['.', '!', '?'];
                let lastSentenceEnd = -1;
                for (const ending of sentenceEndings) {
                    const index = cleanText.indexOf(ending, 1200);
                    if (index !== -1 && (lastSentenceEnd === -1 || index < lastSentenceEnd)) {
                        lastSentenceEnd = index;
                    }
                }
                if (lastSentenceEnd !== -1) {
                    shortAnswer = cleanText.substring(0, lastSentenceEnd + 1);
                } else {
                    shortAnswer += '...';
                }
            }
            const fullResponse = `${getRandomIntro()} ${imageHtml}<br>${shortAnswer}<br><br>${getRandomFollowUp()}`;
            hideTypingIndicator();
            addMessage(fullResponse, false, true);
        } else {
            hideTypingIndicator();
            addMessage('Bu maqola bo\'yicha to\'liq ma\'lumot topa olmadim.', false);
        }
    } catch (error) {
        console.error('To\'liq maqola xatosi:', error);
        hideTypingIndicator();
        addMessage('Ma\'lumot olishda xatolik yuz berdi. Iltimos, qayta urinib ko\'ring!', false);
    }
}

        async function getAIResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            const greetings = ['salom', 'assalomu alaykum', 'hayrli kun', 'qalaysan', 'qandaysan', 'yaxshimisiz'];
            const farewells = ['xayr', 'ko\'rishguncha', 'hayr', 'alvido'];
            const thanks = ['rahmat', 'raxmat', 'tashakkur', 'minnatdorman'];
            const taskTriggers = ['qilib ber', 'tuz', 'tuzib ber', 'bajar'];
            const textProcessingTriggers = [
                'yozib ber', 
                'qisqartirib ber', 
                'tarjima qil', 
                'tahrir qilib ber', 
                'qayta yozib ber', 
                'sarlavha yoz', 
                'matn tuzib ber', 
                'qofiyalab ber', 
                'formatlab ber', 
                'izohlab ber'
            ];
            const alicoderTriggers = ['alicoder', 'islombek bahromov', 'islomjon bahromov'];
            const newTaskTriggers = ['qiber', 'yoz', 'bajar', 'qilasan', 'qilaqo', 'yozasan', 'bajarasan'];
            const aiCapabilityTriggers = ['nima qila olasan', 'nima qiloliysan', 'vazifang nima', 'nima uchun yaratilgansan', 'foundering kim', 'sen kim tomonidan yaratilgansan?', 'seni kim yaratgan', 'seni kim tuzgan', 'ixtiroching kim', 'faundering kim', 'asosching kim', 'senga kim asos solgan', 'ochgan kim', 'xo‘jayining kim', 'xoʻjayining kim', 'xo\'jayining kim', 'ishlab chiqqan kim', 'kim tomonidan ishlab chiqilding', 'kim tomonidan ishlab chiqilgansan', 'kim yaratgan', 'yaratgan kim', 'ixtiro qilgan kim', 'ixtiroching kim', 'kim ixtiro qilgan'];
            const mCorpTriggers = ['m corp', 'mcorp', 'emcorp', 'muhammad bahodirov', 'm corp asoschisi', 'bahodirov muhammad'];

            const getRandomResponse = (responses) => {
                return responses[Math.floor(Math.random() * responses.length)];
            };

            const greetingResponses = [
                'Assalomu Alaykum! Qanday yordam bera olaman?',
                'Salom! Bugun nima haqida suhbatlashamiz?',
                'Yaxshi kun! Savollaringiz bormi?',
                'Salom, do‘stim! Qanday yordam kerak?',
                'Assalom! Nimalarni bilmoqchisiz?'
            ];

            const farewellResponses = [
                'Xayr! Yana murojaat qiling.',
                'Ko‘rishguncha! Yaxshi bo‘ling!',
                'Xayr, do‘stim! Yana uchrashamiz.',
                'Alvido! Savollar bo‘lsa, qaytib keling!',
                'Xayrli kun! Keyinroq suhbatlashamiz.'
            ];

            const thanksResponses = [
                'Arzimaydi! Boshqa savollaringiz bormi?',
                'Rahmat! Yana nima haqida gaplashamiz?',
                'Xush kelibsiz! Savollaringiz qoldimi?',
                'Tashakkur! Yordam kerak bo‘lsa, ayting!',
                'Rahmat sizga! Keyingi savolni kutingman!'
            ];

            const whoAreYouResponses = [
                'Men M Corp tomonidan yaratilgan Grif AI man, mening vazifam foydalanuvchilarga yordam berish, ularning savoliga javob bera olaman, agar sizga ham qandaydur ma\'lumot kerak bo\'lsa, be\'malol so\'rashingiz mumkin',
                'Men Grif AI, M Corp mahsulotiman, savollaringizga javob beruvchi yordamchi!',
                'Men sizning virtual yordamchingizman. Nima haqida bilmoqchisiz?',
                'AI yordamchisi, xizmatingizda! Savollaringiz bormi?',
                'Men raqamli yordamchiman, M Corp dasturchisi tomonidan yaratilganman, savollaringizni savollaringizga javob berishga tayyorman!'
            ];

            const whatCanYouDoResponses = [
                'Men savollaringizga javob berishim, UzWikipedia orqali ma\'lumot izlashim va suhbatlashishim mumkin.',
                'Savollaringizga javob beraman, ma\'lumot topaman va qiziqarli suhbat quraman!',
                'Men har xil mavzularda ma\'lumot beraman va Wikipedia orqali qidiruv qilaman.',
                'Suhbatlashish, ma\'lumot izlash va savollarga javob berish — mening ishlarim!',
                'Savollaringizni tahlil qilaman va UzWikipedia orqali javob topaman!'
            ];

            const noInfoResponses = [
                'Bu mavzu bo\'yicha ma\'lumot topa olmadim. Iltimos, boshqa savol bering!',
                'Afsus, bu haqda ma\'lumot yo‘q. Boshqa nima haqida bilmoqchisiz?',
                'Hech narsa topilmadi. Boshqa savol bilan sinab ko‘ring!',
                'Bu so‘rov bo‘yicha ma\'lumot yo‘q. Yana bir savol berasizmi?',
                'Kechirasiz, bu haqda hech narsa topa olmadim. Boshqa savolingiz bormi?'
            ];

            const textProcessingResponses = [
                'Kechirasiz, hurmatli foydalanuvchi, men matn yozish yoki tahrirlash bo\'yicha hali to\'liq ishlay olmayman. M Corp yaqinda bu funksiyalarni qo\'shishi mumkin. Boshqa savolingiz bo\'lsa, bemalol so\'rang!',
                'Uzr, aziz foydalanuvchi, matn bilan ishlash funksiyalari hozircha mavjud emas. M Corp bu imkoniyatlarni tez orada qo\'shadi deb umid qilamiz. Yana nima haqida bilmoqchisiz?',
                'Afsus, men hali matn yozish yoki qayta ishlash vazifalarini bajarolmayman. M Corp ushbu xususiyatlarni yaqin kelajakda qo\'shishi mumkin. Boshqa savollaringiz bormi?'
            ];

            const taskResponses = [
                'Kechirasiz, men hozir kod yozish va tuzatish bo\'yicha hali to\'liq tayyor emasman, lekin yaqin kunlarda M Corp tomonidan ushbu funksiyalar qo\'shilishi rejalashtirilmoqda. Boshqa savolingiz bo\'lsa, bemalol so\'rang!',
                'Uzr, aziz foydalanuvchi, men hali kod yozish yoki tuzatish vazifalarini bajarolmayman. M Corp bu imkoniyatlarni tez orada joriy qiladi deb umid qilamiz. Yana nima haqida bilmoqchisiz?',
                'Afsus, men hozircha kod bilan ishlash bo\'yicha to\'liq tayyor emasman. M Corp yaqin kelajakda bu funksiyalarni qo\'shishi mumkin. Boshqa savollaringiz bormi?'
            ];

            const alicoderResponses = [
                'Alicoder — yosh dasturchi, kontent yaratuvchi va yoshdasturchi.uz platformasining asoschisi. U dasturlash bo‘yicha bilimlarni sodda va tushunarli shaklda o‘rgatish, yoshlarni IT sohasiga jalb qilish hamda amaliy loyihalar orqali ularning tajribasini oshirishga katta e’tibor beradi. Alicoder o‘z auditoriyasi bilan ijtimoiy tarmoqlar, veb-sayt va turli onlayn darslar orqali muloqot qiladi. Uning asosiy maqsadi — O‘zbekistonda zamonaviy IT-mutaxassislar avlodini tarbiyalash va texnologiyalarni ommalashtirish.',
                'Alicoder — bu web dasturlash bo‘yicha ma\'lumotlar, frontend va backend dasturlash kurslari hamda dastur yaratish bo\'yicha qo\'llanmalarni taqdim etadigan platforma. Alicoder.uz sayti orqali web dasturchilikka oid ko\'plab darsliklar va kurslarni topish mumkin. Alicoderning asosiy shaxslaridan biri Islomjon Baxromov bo\'lib, u 3 yildan ortiq tajribaga ega web dasturchi va o\'qituvchidir.'
            ];

            const newTaskResponses = [
                'Kechirasiz, sizdan uzr so\'rayman, men hali beri siz aytayotgan mavzular bo\'yicha sizga to\'liq yordam bera olmayman, lekin M Corp tomonidan ushbu funksiyalar qo\'shilishi mumkin, boshqa savollaringiz bo\'lsa marhamat so\'rang!',
                'Afsus, men hozircha bunday vazifalarni bajarishga to\'liq tayyor emasman. M Corp yaqin kelajakda bu imkoniyatlarni qo\'shishi mumkin. Boshqa savolingiz bormi?'
            ];

            const aiCapabilityResponses = [
                'Men M Corp tomonidan yaratilgan Grif AI man, mening vazifam foydalanuvchilarga yordam berish, ularning savoliga javob bera olaman, agar sizga ham qandaydur ma\'lumot kerak bo\'lsa, be\'malol so\'rashingiz mumkin',
                'Grif AI sifatida, M Corp tomonidan ishlab chiqilganman. Foydalanuvchilarga savollariga javob berish va yordam ko\'rsatish mening asosiy vazifam. Nima haqida bilmoqchisiz?'
            ];

            const mCorpResponses = [
                'M Corp dasturi Dasturchi Muhammad Bahodirov tomonidan ishlab chiqarilgan loyihadir, ushbu loyiha Grif AI ni o\'z ichiga oladi.',
                'M Corp — Muhammad Bahodirov tomonidan asos solingan loyiha bo‘lib, unda Grif AI kabi innovatsion AI yordamchilari ishlab chiqiladi.'
            ];

            if (mCorpTriggers.some(trigger => lowerMessage.includes(trigger))) {
                return getRandomResponse(mCorpResponses);
            } else if (aiCapabilityTriggers.some(trigger => lowerMessage.includes(trigger))) {
                return getRandomResponse(aiCapabilityResponses);
            } else if (newTaskTriggers.some(trigger => lowerMessage.includes(trigger))) {
                return getRandomResponse(newTaskResponses);
            } else if (alicoderTriggers.some(trigger => lowerMessage.includes(trigger))) {
                return getRandomResponse(alicoderResponses);
            } else if (taskTriggers.some(trigger => lowerMessage.includes(trigger))) {
                return getRandomResponse(taskResponses);
            } else if (textProcessingTriggers.some(trigger => lowerMessage.includes(trigger))) {
                return getRandomResponse(textProcessingResponses);
            } else if (greetings.some(greeting => lowerMessage.includes(greeting))) {
                return getRandomResponse(greetingResponses);
            } else if (farewells.some(farewell => lowerMessage.includes(farewell))) {
                return getRandomResponse(farewellResponses);
            } else if (thanks.some(thank => lowerMessage.includes(thank))) {
                return getRandomResponse(thanksResponses);
            } else if (lowerMessage.includes('kim') && lowerMessage.includes('san')) {
                return getRandomResponse(whoAreYouResponses);
            } else if (lowerMessage.includes('nima') && lowerMessage.includes('qila olasan')) {
                return getRandomResponse(whatCanYouDoResponses);
            } else {
                const mainTopic = extractMainTopic(userMessage);
                if (mainTopic) {
                    await searchWikipedia(mainTopic);
                    return '';
                }
                return getRandomResponse(noInfoResponses);
            }
        }

        function sendMessage() {
    const userInput = document.getElementById('userInput');
    const inputContainer = document.querySelector('.input-container');
    const brandName = document.querySelector('.brand-name');
    
    if (userInput.value.trim() !== '') {
        const userMessage = userInput.value.trim();
        addMessage(userMessage, true);
        
        if (isFirstMessage) {
            inputContainer.classList.add('first-message-sent');
            mobileLogoContainer.classList.add('hidden');
            brandName.classList.add('raised'); // Brand nomini tepaga ko'tarish
            isFirstMessage = false;
        }
        
        showTypingIndicator();
        getAIResponse(userMessage).then(aiResponse => {
            if (aiResponse) {
                setTimeout(() => {
                    hideTypingIndicator();
                    addMessage(aiResponse, false);
                }, 500);
            }
        });
        userInput.value = '';
        inputContainer.style.display = 'flex';
    }
}

        function startSpeechRecognition() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'uz-UZ';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            micButton.classList.add('listening');

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                userInput.value = transcript;
                if (transcript.trim() !== '') {
                    sendMessage();
                }
                micButton.classList.remove('listening');
            };

            recognition.onerror = function(event) {
                console.error('Ovoz aniqlash xatosi:', event.error);
                micButton.classList.remove('listening');
                addMessage('Ovozli kiritishda xato yuz berdi. Iltimos, qayta urinib ko\'ring!', false);
            };

            recognition.onend = function() {
                micButton.classList.remove('listening');
            };

            recognition.start();
        }

        userInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && this.value.trim() !== '') {
                sendMessage();
            }
        });

        window.speechSynthesis.onvoiceschanged = () => {
            const voices = window.speechSynthesis.getVoices();
        };
    </script>
</body>
</html>